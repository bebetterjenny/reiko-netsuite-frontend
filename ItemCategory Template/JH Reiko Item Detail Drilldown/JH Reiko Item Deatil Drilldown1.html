<td  width="100%" align="left" valign="top">
<div class="listsixcontainer">
<div class="itemdrilldownhalf01">
<div id="flexslider01" class="product-info-leftZZZ">
<ul class="slides thumbnails popup-gallery">
<li class="thumb3" data-thumb="<%=getCurrentAttribute('item','storedisplayimage')%>">
<div class="thumb2">
<div class="itemdetailimage"><a title='<%=getCurrentAttribute('item','storedisplayname2')%>' href='<%=getCurrentAttribute('item','storedisplayimage')%>'><img class="largeimage" data-zoom-image="<%=getCurrentAttribute('item','storedisplayimage')%>" src='<%=getCurrentAttribute('item','storedisplayimage')%>' border='0' alt='<%=getCurrentAttribute('item','storedisplayname2')%>' title='<%=getCurrentAttribute('item','storedisplayname2')%>'></a></div>
</div>
</li>
<li class="thumb3" data-thumb="<%=getCurrentAttribute('item','custitem3')%>">
<div class="thumb2">
<div class="itemdetailimage"><a title='<%=getCurrentAttribute('item','storedisplayname2')%>' href='<%=getCurrentAttribute('item','custitem3')%>'><img class="largeimage" data-zoom-image="<%=getCurrentAttribute('item','custitem3')%>" src='<%=getCurrentAttribute('item','custitem3')%>' border='0' alt='' title=''></a></div>
</div>
</li>
<li class="thumb3" data-thumb="<%=getCurrentAttribute('item','custitem4')%>">
<div class="thumb2">
<div class="itemdetailimage"><a title='<%=getCurrentAttribute('item','storedisplayname2')%>' href='<%=getCurrentAttribute('item','custitem4')%>'><img class="largeimage" data-zoom-image="<%=getCurrentAttribute('item','custitem4')%>" src='<%=getCurrentAttribute('item','custitem4')%>' border='0' alt='' title=''></a></div>
</div>
</li>
<li class="thumb3" data-thumb="<%=getCurrentAttribute('item','custitem5')%>">
<div class="thumb2">
<div class="itemdetailimage"><a title='<%=getCurrentAttribute('item','storedisplayname2')%>' href='<%=getCurrentAttribute('item','custitem5')%>'><img class="largeimage" data-zoom-image="<%=getCurrentAttribute('item','custitem5')%>" src='<%=getCurrentAttribute('item','custitem5')%>' border='0' alt='' title=''></a></div>
</div>
</li>
</ul>
</div>
</div>


<div class="itemdrilldownhalf02">
<div class="responsive-tabs">
					<h4 id="spotlight-hea111d">PRICING</h4>
					<div id="spotlight-content22">
						 	<h1 class="drilldownheader"><%=getCurrentAttribute('item','storedisplayname2')%></h1>
							<p style="font-size: 19px; margin-bottom: 18px;"><%=getCurrentAttribute('item','displayname')%></p>
							
<p class="upcontainer"><%=getCurrentAttribute('item','custitem_rw_items_boxandcase')%> PCS/PACK &nbsp &nbsp <%=getCurrentAttribute('item','custitem_rw_unitpercase')%> PCS/BOX<br /><span class="upcontainer">UPC CODE: <%=getCurrentAttribute('item','upccode')%></span></p>

<div class="qtyavailablecontainer" style="display: none;"><%=getCurrentAttribute('item','quantityavailable')%></div>
<div class="minquancontainer" style="display: none;"><%=getCurrentAttribute('item','minimumquantity')%></div>
		
							
							
							
<!--<div class="drilldownhalf01"><span class="priceheader">Price </span></div><div class="drilldownhalf02"><span class="price2">$XXX<span style="color: black;">/Piece</span></span></div><br />-->

<div class="drilldownhalf02">
</div>

<div style="clear: both !important;"></div>
<div style="clear: both !important;"></div>

<div class="qtycont">
<div class="drilldownhalf01"></div>
<div style="clear: both !important;"></div>
</div>

<div class="totalcont">

<div class="drilldownhalf01"></div>
<div class="drilldownhalf02"><span class="price3"></span></div>
<div style="clear: both !important;"></div>
</div>
 
<!-- *** START ADD-TO-CART - Basic : Flat Blocks PRODUCTS (item drilldown) *** -->
				<TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
					<FORM method='post' name='form<%=getCurrentAttribute('item', 'internalid')%>' id='form<%=getCurrentAttribute('item', 'internalid')%>' onsubmit='return checkmandatory<%=getCurrentAttribute('item', 'internalid')%>();' action='/app/site/backend/additemtocart.nl'>
					<TR> 
						<TD class="qtycontainer" height="20" width="100%">
						<div class="promoitem"><DIV><%=getCurrentAttribute('item', 'custitem21')%></DIV></div>

						<DIV class="txt18b-red item-price"><%=getCurrentAttribute('item', 'salesPriceDrilldownHtml')%></DIV>
						
						
						
						
						<div>


						<span class="itemprice" id="itemprice<%=getCurrentAttribute('item', 'internalid')%>"></span>

				
						
						<!--
						<span class="qty4">Qty:  </span>
						<input value="1" id="quantity_<%=getCurrentAttribute('item','internalid')%>" class="quantity qty2"></input>
						<a id="addtocart_<%=getCurrentAttribute('item','internalid')%>" class="addtocart">ADD TO CART</a>
						-->
						
						
						
						
						</div>
						
						
						
						
						
						
						</TD>
						<TD width="10"><IMG src="/images/store/templates/common/spacer.gif" height="10" width="10"></TD>
					</tr>
					
					<tr><td><div class="removematrixmessagecontainer"><NXSIZEGUIDE></td></tr>
					<tr class="matrix-options">
						<td colspan=3 class="txt11-grey">
						
						
							<TABLE id="options" width="100%" border="0" cellspacing="0" cellpadding="0">
								<%=getCurrentAttribute('item','addtocartoptionshtml')%>
							</table>
						</td>
					</tr>
					<TR class="outofstockcontainer2"> 
						<TD colspan=3>
							<!--<IMG src="/images/store/templates/common/spacer.gif" height="3" width="1"><br>-->
							<TABLE width="200" border="0" cellspacing="0" cellpadding="0">
								<TR align=left>
							    	<%=getCurrentAttribute('item','addToCartDrillDownHtml')%>
								</TR>
								
								<tr><TD class="outofstockcontainer"><%=getCurrentAttribute('item','stockStatusMessageHTML')%></TD></tr>
								
							</TABLE>
						</TD>
					</TR>
					<TR> 
						<TD colspan=3 class="txt11-grey">
							<IMG src="/images/store/templates/common/spacer.gif" height=10 width=1>
							<TABLE width="200" border="0" cellspacing="0" cellpadding="0">
								<TR align=left>
									<TD>
 									</TD>
								</TR>
							</TABLE>
						</TD>
					</TR>
                   <TR>
                       <TD class='medtext' colspan=3>&nbsp;</TD>
                   </TR>
                   <TR>
                       <TD colspan=3 class="txt11-grey">
			              	<TABLE width="200" border="0" cellspacing="0" cellpadding="0">
				            	<TR align=left>
 					             	<TD><%=getCurrentAttribute('item','tellafriendlinkhtml')%>
					                </TD>
				                </TR>
				            </TABLE>
			             </TD>
                   </TR>
					</FORM> 
				</TABLE>
				<!-- *** END ADD-TO-CART - Basic : Flat Blocks PRODUCTS (item drilldown) *** -->
				
				
				
			 
<!--<div class="addtofavorites"><a href="#"><i class="fa fa-heart"></i> Add to Favorite Items</a></div>-->

<div id="wish_list">
	<div class="addtofavorites" id="wish_list_text"><span id="addWishlist"><i class="fa fa-heart"></i> Add to Favorites</span></div>
</div>
<div id="wish-alerts"></div>

</div>



					<h4>DETAILS</h4>
					<div class="specs-content333">
						<h1 class="drilldownheader"><%=getCurrentAttribute('item','storedisplayname2')%></h1>
						<p style="font-size: 19px; margin-bottom: 18px;"><%=getCurrentAttribute('item','displayname')%></p>
<p class="upcontainer"><%=getCurrentAttribute('item','custitem_rw_items_boxandcase')%> PCS/PACK &nbsp &nbsp <%=getCurrentAttribute('item','custitem_rw_unitpercase')%> PCS/BOX<br /><span class="upcontainer">UPC CODE: <%=getCurrentAttribute('item','upccode')%></span></p>
						<div class="square">
							<div><%=getCurrentAttribute('item','storedescription')%></div>
						</div>
						<div class="itemdrilldownhalf02inner01">
	<h1>BRAND:</h1>
	<h1>CATEGORY:</h1>
	<h1>YEAR:</h1>
	<h1>DEVICE:</h1>
	<h1>MODEL:</h1>
	<h1>CARRIER:</h1>
</div>

<div class="itemdrilldownhalf02inner02">
<div class="brand"><%=getCurrentAttribute('item','custitem6')%></div>
<div class="category"><%=getCurrentAttribute('item','custitem7')%></div>
<div class="year"><%=getCurrentAttribute('item','custitem_rw_productyearfield')%></div>
<div class="devicemodel"><%=getCurrentAttribute('item','custitem8')%></div>
<div class="model"><%=getCurrentAttribute('item','custitem_rw_itemmodel')%></div>
<div class="carrier"><%=getCurrentAttribute('item','custitem_rw_carrierselet')%></div>

<!--<div class="color"><%=getCurrentAttribute('item','custitem_rw_color')%></div>
<div class="chinadirect"><%=getCurrentAttribute('item','custitem_rw_chinadirect')%></div>
<div class="comingsoon"><%=getCurrentAttribute('item','custitem13')%></div>
<div class="onsale"><%=getCurrentAttribute('item','custitem12')%></div>
<div class="newarrivals"><%=getCurrentAttribute('item','custitem11')%></div>
<div class="popularitem"><%=getCurrentAttribute('item','custitem_rw_popularitem')%></div>
-->	
</div>
<div style="clear: both !important;"></div>


<form id="multi-add-form" method='post' action='http://reikowireless.com/app/site/backend/additemtocart.nl' style="display: none;">
<p align="left"><input class='bgbutton' type="submit" value="Enter Store"></p>
<input type='hidden' name='c' value='4342530'>
<input type=hidden name='qtyadd' id='qtyadd' value='1'>
<input type=hidden name='buyid' id='buyid' value='multi'>
<input type=hidden name='multi' id='multi' value=''>
</form>



<div class="qtycont">
<div class="drilldownhalf01"></div>
<div class="drilldownhalf02"></div>
</div>

<div class="totalcont"> 
<div class="drilldownhalf01"></div>
<div class="drilldownhalf02"><span class="price3"></span></div>

</div>

 
				
 
<!--<div class="addtofavorites"><a href="#"><i class="fa fa-heart"></i> Add to Favorite Items</a></div>-->


<div style="clear: both !important;"></div>

 

</div>


</div><!-- END responsive-tabs -->	







</div>

<div class="ordersheet" id="ordersheet"></div>

<div class="bestsellerscontainer stickyerNOTANYMORE">
	<NXBESTSELLERS>
</div>

<div style="clear: both !important;"></div>

 

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
		<TR>
			<%=getCurrentAttribute('item','allrelateditemshtml')%>
		</TR>
</TABLE>

<TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
		<TR>
		<%=getCurrentAttribute('item','correlateditemshtml')%>
		</TR>
</TABLE>

<div style="clear: both !important;"></div>

 

<div style="clear: both !important;"></div>

</div>

				

<div style="clear: both !important;"></div>

</div>

<script id="ordersheet-table" type="text/x-handlebars-template">
<table class="ordersheet-table">
	<thead>
		<tr>
			<th colspan="2">Order Sheet</th>
			<th>Size</th>
			<th>Qty</th>
			<th>Unit Price</th>
			<th>Subtotal</th>
            <th>In Stock</th>
		</tr>
	</thead>
	<tbody class="ordersheet-items"></tbody>
	<tfoot>
	<tr>
		<th colspan="3"></th>
		<th>TOTAL</th>
		<th><span class="order-total">${{orderTotal}}</span></th>
		<th><button id="add-all-items" class="matrix-add btn btn-cart">Add All to Cart</button></th>
	</tr>
	</tfoot>
</table>
</script>

<script id="ordersheet-item" type="text/x-handlebars-template">
<tr class="os-item" data-itemid="{{id}}">
	<td class="os-item__image cell">
		<img width="50" height="50" src="{{image}}"/>
	</td>
	<td class="os-item__color cell">
		{{color.name}}
	</td>
	<td class="os-item__size cell">
		{{size.name}}
	</td>
	<td class="os-item__qty cell">
		<input type="number" name="quantity" value="{{quantity}}">
	</td>
	<td class="os-item__price cell">
		${{price}}
	</td>
	<td class="os-item__subtotal cell">
		${{subtotal}}
	</td>
    <td class="os-item__instock cell">
		{{instock}}
	</td>
	<td></td>

</tr>
</script>

<script type="text/javascript">
			
				
				
				
				
				
	// Order Sheet
	jQuery(function ($) {
		var orderTable = Handlebars.compile($('#ordersheet-table').html());
		var orderItemTemplate = Handlebars.compile($('#ordersheet-item').html());
		// configuration
		var matrixFields = {
			size: 'custcol6',
			color: 'custcol7'
		};
		// global vars
		var orderSheet = window.orderSheet = {
			items: {},
			total: 0.00,
			addItem: function (item) {
				this.items[item.id] = item;
			},
			getItem: function (id) {
				return this.items[id] || false;
			},
			changePrice: function (id, price) {
				var orderItem = this.getItem(id);
				orderItem.price = price;
				return price;
			},
			changeQuantity: function (id, val) {
				var orderItem = this.getItem(id);
				if (orderItem && val >= 0) {
					orderItem.subtotal = orderItem.price * val;
					orderItem.quantity = val;
					return orderItem.subtotal;
				}
				return false;
			}
		};
		// var orderSheet = window.orderSheet = [];
		// var orderTotal = window.orderTotal = 0.00;
		// ref to common els
		var $cartBtnContainer = $('input[name="addtocart"]').parent();
		var $matrixOptions = $('.matrix-options');
		// get rid of default cart button and replace with add to order sheet button
		var osAddBtnHTML = '<button id="add-to-order" class="ordersheet btn btn-add-item" disabled>Add To Order Sheet</button><style>#addtocart {display: none;}.removematrixmessagecontainer {display: block !important;}.relatedheader, .classytablerelated, .bestsellerscontainer, #wish_list {display: none !important;}</style>';
		// $cartBtnContainer.find('input[name="addtocart"]').remove()
		// $cartBtnContainer.append(osAddBtnHTML);
		// simple function for clearing the alert container contents
		var clearAlert = function () {
			$('ordersheet-alert').text('');
		};
		
		// handle to order sheet add item button and add all ordersheet items to cart btn
		var $osAddBtn = $cartBtnContainer.find('#add-to-order');
		var $addAllBtn = $('#add-all-items');
		// checks if required matrix options are selected
		var isReadyToAdd = function (optEls) {
			return _.every(optEls, function (x) {
				return x.val() && x.val() !== '';
			});
		};
		var getTotal = function (items) {
			var newTotal = 0;
			for (var key in items) {
				newTotal += parseFloat(items[key].subtotal)
			}
			return newTotal;
		};
		// adds all ordersheet items to the shopping cart
		var addAllToCart = function () {
			var itemId = '<%=getCurrentAttribute("item", "internalid")%>';
			var baseUrl = '/app/site/backend/additemtocart.nl?c=4342530&buyid=multi&multi=';
			// var cartUrl = orderSheet.reduce(function (acc, x) {
			// 	return acc += (itemId + ',' + x.quantity + ',' + x.color.id + '|' + x.color.value + '||' + x.size.id + '|' + x.size.value + ';');
			// }, '');
			// get rid of trailing ;
			// cartUrl = cartUrl.slice(0, --cartUrl.length);
			var items = _.map(orderSheet.items, function (x) {
				return [x.internalid, x.quantity]
			});
			// console.log(items);
			$.ajax('/cart/addAll.ss?items=' + JSON.stringify(items))
				.done(function (data) {
					try {
						data = JSON.parse(data);
						if (data.error) throw data.error;
						window.location.href = 'http://reikowireless.com/sbe-dev-montblanc/cart.ssp?sc=3#cart';
					} catch (err) {
						console.error(err);
					}
				});
			//
			//	ATTEMPT ONE
			//
			// $.ajax({
			// 	method: 'POST',
			// 	url: baseUrl + queryParams
			// }).done(function () {
			// 	$('ordersheet-alert').css('color', 'green').text('The odersheet has been added to your cart.');
			// 	$('.ordersheet-table').remove();
			// 	orderSheet = [];
			// })
			//
			//	ATTEMPT TWO
			//
			// console.log('cartUrl: ', 'http://' + window.location.hostname + cartUrl);
			// window.location.href = 'http://' + window.location.hostname + cartUrl;
			//
			//	ATTEMPT THREE
			//
			// var addCartLinkEl = '<a href="' + cartUrl + '" id="add-cart-link" style="display: none;">cart</a>';
			// $('#add-all-items').parent().append(addCartLinkEl);
			// $('#add-cart-link').click();
			//
			// ATTEMPT FOUR
			//
			// var $addCartFormEl = $('#multi-add-form');
			// $addCartFormEl.find('input[name="multi"]').val(cartUrl);
			// $addCartFormEl.find('input').each(function () {
			// 	console.log($(this));
			// 	console.log($(this).val());
			// })
			// $addCartFormEl.submit();
		};
		var getQuantityPrice = function (quant) {
			var quantityPrice = 0.00;
			var $itemPriceEl = $('.item-price > table');
			if (!quant) quant = 1;
			if ($itemPriceEl && $itemPriceEl.length > 0) {
				var $priceElRows = $itemPriceEl.find('tr');
				$priceElRows.each(function (idx) {
					if (idx === 0) return;
					var $rangeEl = $(this).find('td:first-of-type');
					var rangeText = $rangeEl.text();
					var rangePrice = parseFloat($(this).find('td:last-of-type').text().slice(1));
					var ranges = rangeText.split('â€“');
					var minRange = ranges.shift();
					var maxRange = ranges.pop();
					if (minRange && typeof minRange === 'string' && minRange.indexOf('+') >= 0) {
						minRange = parseInt(minRange.slice(0, minRange.indexOf('+')))
						// minRange = parseInt(minRange.trim().split('').pop().join(''));
						maxRange = false;
					} else if (!minRange) {
						minRange = 0;
					} else {
						minRange = parseInt(minRange.trim());
					}
					if (maxRange) {
						maxRange = parseInt(maxRange.trim());
					} else {
						maxRange = false;
					}
					// console.log('minRange: ', minRange);
					// console.log('maxRange: ', maxRange);
					
					if (quant >= minRange && (quant <= maxRange || !maxRange)) {
						quantityPrice = rangePrice;
					}
				});
			}
			return quantityPrice;
		};
	
		// creates an array of matrix options available on the item
		var options = _.filter(matrixFields, function (v) {
			var $field = $matrixOptions.find('select[name="' + v + '"]');
			return $field.length > 0;
		});
		// if theres no options we can retire because its not a matrix item
		if (options.length <= 0) return;
		// var itemPrices = window['Item<%=getCurrentAttribute("item", "internalid")%>_prices'];
		
		$('select[name="custcol6"]').closest('tr').css('display', 'none');
		$('input[name="qty"]').css('display', 'none');
		$('#addtocart').css('display', 'none');
		$('#wish-list').css('display', 'none');
		// add a container for displaying alert/error
		var alertBoxHTML = '<div class="ordersheet-alert"></div><style>#addtocart {display: none;}.removematrixmessagecontainer {display: block !important;}.relatedheader, .classytablerelated, .bestsellerscontainer, #wish_list, .upcontainer {display: none !important;}</style>';
		$cartBtnContainer.append(alertBoxHTML);
		// render the ordersheet on the first item		
		$('#ordersheet').html(orderTable());
		
		// init event handlers
		$('#add-all-items').click(addAllToCart);
		// // handle to option's select els
		var optionEls = _.map(options, function (v, k) {
			return $('tr.matrix-options select[name="' + v + '"]');
		});
		$('tr.matrix-options select[name="custcol6"] option').each(function () {
			
			var sizeEl = $(this);
			console.log(sizeEl.val() + ': ' + sizeEl.text());
			if (!sizeEl || !sizeEl.val() || !sizeEl.val() === '') return;
			// if (sizeEl.length || !sizeEl.val() || sizeEl.val() === '') return;
			// sizeEl.val(sizeEl.val()).change();
			var size = {
				id: matrixFields.size,
				name: sizeEl.text(),
				value: sizeEl.val()
			};
			// jeeez.... gets qty and price
			// var quantity = parseInt($('input[name="qty"]').val());
			var price = 0;
			if (window['syncItemPrice<%=getCurrentAttribute("item", "internalid")%>'] && typeof window['syncItemPrice<%=getCurrentAttribute("item", "internalid")%>'] === 'function') {
			 	price = Item<%=getCurrentAttribute("item", "internalid")%>_prices[size.value];
				if (price && typeof price === 'string') price = parseFloat(price.slice(1));
			}	
			if (!price) price = $('span.itemprice').text();
			// var price = $('span.itemprice').text(); // sizeEl.attr('data-itemprice');
			console.log(price);
			// $('//#itemprice<%=getCurrentAttribute("item", "internalid")%>') //itemPrices[$(this.val)]
			// var price = parseFloat($('.qtycontainer span').text().slice(1));
			var renderItem = function (item) {
				// console.log(item);
				// $('.ordersheet .order-total').html('$' + newTotal.toFixed(2));
				var compiledOrderItem = orderItemTemplate(item);
				$('.ordersheet-table tbody').append(compiledOrderItem);
			};
			// generate a unique id for entry	
			var genItemId = function (str) {
			    var hash = 0;
			    for (var i = 0; i < str.length; i++) {
	        		hash = ~~(((hash << 5) - hash) + str.charCodeAt(i));
   				 }
    			return hash;
			};
			if (!price) {
				price = _.filter(_.map($('.item-price').text().split(' '), function (x) {
					return parseFloat(x.slice(1));
				}), function (x) {
					return !isNaN(x);
				}).shift();
			}
			if (!price || isNaN(price)) {
				price = getQuantityPrice(0);
				//if (price) hasPriceBreaks = true;
			}
			var itemId = genItemId(size.value);
			var ordersheetItem = {
				id: itemId,
				internalid: sizeEl.attr('data-internalid'),
				size: size,
				price: price.toFixed(2),
				quantity: 0,
				subtotal: 0.00,
				image: $('.flex-control-thumbs li:first-of-type img').attr('src'),
                instock: "Out of stock"
			};
			orderSheet.addItem(ordersheetItem);
			renderItem(ordersheetItem);
		});
		orderSheet.total = 0.00;
		$('.ordersheet .order-total').html('$0.00');
		$(document).on('change', 'input[name="quantity"]', function (e) {
			var val = parseInt($(e.target).val());
			if (!val || isNaN(val) || 0 > val) { 
				val = 0;
				$(e.target).val(val)
			}
			var $itemEl = $(e.target).closest('.os-item');
			var id = $itemEl.attr('data-itemid');
			
			// var qPrice = getQuantityPrice(val);
			$('select[name="custcol6"] option').each(function (i, opt) {
//				console.log(opt);
				if ($(opt).text().trim() ===  $itemEl.find('.os-item__size').text().trim()) {
					$(opt).prop('selected', true);
				}
			});
			// if (!isNaN(qPrice) && qPrice > 0) {
			// 	var updatedPrice = orderSheet.changePrice(id, qPrice);
			// 	$itemEl.find('.os-item__price').text('$' + updatedPrice.toFixed(2));
			// }
			var itemSubtotal = orderSheet.changeQuantity(id, val);
			// orderSheet.items[id].quantity = orderSheet.items[id].quantity !== val ? val : 0;
			if (itemSubtotal !== false && itemSubtotal >= 0) {
				$itemEl.find('.os-item__subtotal').text('$' + itemSubtotal.toFixed(2));
			}
			// console.log(orderSheet);
			orderSheet.total = getTotal(orderSheet.items);
			$('.ordersheet .order-total').html('$' + orderSheet.total.toFixed(2));
		});
		$.ajax('/app/site/hosting/scriptlet.nl?script=212&deploy=1&itemid=<%=getCurrentAttribute("item", "internalid")%>')
		.done(function (res) {
//			console.log(res);
			var data;
			try {
				data = JSON.parse(res);
			} catch (err) {
				console.error(err);
				data = {};
			}
			_.each(optionEls, function ($el) {
				$el.find('option').each(function () {
					var optName = $(this).text();
					// console.log(optName);
					var item = _.find(data, {size: optName});
					if (item) {
						$(this).attr('data-internalid', item.id);
						_.each(orderSheet.items, function (itm) {
							if (itm.size.name === optName) {
								itm.internalid = item.id;
								itm.price = item.onlinecustomerprice;
							}
						});
					}
				});
			});
			// console.log('orderSheet.items: ', orderSheet.items);
            $.each(data, function(i, v){
                var message = parseInt(v.instock)>0 ? "in stock" : "out of stock";
                $($(".os-item__instock")[i]).html(message);
            });
		});
	});
		// Wish List
		$(document).ready(function(){
		$("#wish_list_text").click(function(e) {
				var $alerts = $('#wish-alerts'),
				$this = $(this);
				$alerts.slideUp(function() {
					var customer = '<%=getCurrentAttribute("customer","internalId")%>';
					if (customer) {
						var labels = [],
						options = [],
						valid = true,
						//need to make sure you update this to the name of table that contains
						//matrix options
						$options = $('#options').closest('div').find('select');
						var qty = $('#qty').val();
						$options.each(function() {
							var $this = $(this),
							$selected = $this.children(':selected'),
							label = $.trim($this.closest('tr').children(':first').text());
							if ($selected.val() == '') {
								labels.push(label);
								valid = false;
							}
							else {
								options.push('{"id":"' + $this.attr('id') + '","label":"' + label + '","text":"' + $selected.text() + '","value":"' + $selected.val() + '"}');
							}
						});
						if (valid) {
							$this.addClass('loading').text('Adding to Favorites...');
							$.get('/app/site/hosting/scriptlet.nl', {
								action: 'addToWishlist',
								customer: '<%=getCurrentAttribute("customer","internalId")%>',
								minimumqty: qty,
								deploy: 'customdeploy_wishlist',
								item: '<%=getCurrentAttribute("item","internalid")%>',
								options: '[' + options.join(',') + ']',
								script: 'customscript_wishlist',
								siteNumber: 1
							},
							function(data) {
								$this.removeClass('loading');
								if (parseFloat(data) > 0) {
									$alerts.html('This item has been added to <a href="/favorites">Your Favorites</a>').slideDown();
									$this.slideUp();
								}
								else {
									$this.removeClass('loading').text('Add to Favorites');
									$alerts.text('We are sorry, there has been a problem in our servers, please try again.').slideDown();
								}
							})
						}
						else {
							$alerts.text('Please select a value for: ' + labels.join(', ')).slideDown();
						}
					}
					else {
						$alerts.html('You need to be logged in to add an item to your list. <br /> <a href="<NLLOGINURL>">Click here</a> to login.').slideDown();
					}
				});
				e.preventDefault();
			});
		});
	</script>
</td>